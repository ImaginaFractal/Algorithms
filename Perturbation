#pragma once
#include <Imagina/evaluator>

namespace Perturbation {
	using namespace Imagina;

	class PerturbationEvaluator {
		using real = SRReal;
		using complex = SRComplex;
		struct Output {
			double Value;
		};

		StandardEvaluationParameters parameters;

		uint64_t referenceLength;
		complex *reference = nullptr;

	public:
		const PixelDataInfo *GetOutputInfo();

		void Precompute(const HPReal &x, const HPReal &y, HRReal radius, const StandardEvaluationParameters &parameters);
		void Evaluate(IRasterizingInterface rasterizingInterface);
	};
}

IMPLEMENT_INTERFACE(Perturbation::PerturbationEvaluator, Imagina::IEvaluator);
